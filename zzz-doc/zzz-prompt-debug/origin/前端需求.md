### 背景
一个桌宠，live2d模型，可以实现代码控制表情，动作，移动等
### 想要的效果
想要的效果：可以自用使用鼠标拖动，想一个桌宠一样，只有模型，没有electron的框，也就是，electorn是透明的，悬浮模型会出现菜单设置选项，底下有一个小的对话框，对话后会有气泡，可以自动识别当前活动窗口，可以自动在这个窗口贴边，多个窗口，随机选择，有全屏的窗口，就变成一个类似下拉的小球，点一下可以唤起，同时可以识别我正在做什么，使用win下的底层api加模型的多模态识别，来判断。
是不是还需要什么包下载到本地，如果想要展示live2d的话，使用moc3格式，同时使用代码来控制

下载 Live2D Cubism SDK for Web。

提取 Core/live2dCubismCore.min.js。

放置于项目：frontend\models\core\live2dcubismcore.js

在 index.html 引入：<script src="frontend\models\core\live2dcubismcore.js"></script>。

### 技术栈

| 类别 | 选型 |
|------|------|
| 桌面框架 | Electron |
| 前端框架 | React |
| 构建工具 | Vite |
| 包管理器 | pnpm |
| 语言 | TypeScript |
| Live2D 渲染 | pixi-live2d-display |
| 模型格式 | .model3.json (Live2D Cubism 3/4/5) |

### 依赖安装

```bash
pnpm add pixi.js pixi-live2d-display
```

---

### 功能需求

#### 1. 模型展示与控制
- Live2D 模型渲染展示
  - 支持 .model3.json 格式
  - 模型加载与渲染
- 代码控制表情、动作、移动
- 面补效果（表情平滑过渡）

#### 2. 交互功能
- **拖动**：鼠标拖动模型自由移动
- **悬浮菜单**：hover 模型时显示设置选项
- **底部对话框**：小对话框 + 对话气泡

#### 3. 窗口管理
- **窗口识别**：自动识别当前活动窗口
- **贴边停靠**：在当前窗口边缘贴边
- **随机窗口**：多窗口时随机选择停靠
- **全屏模式**：全屏窗口时变成下拉小球，点击唤起

#### 4. 用户行为识别
- 使用 Windows 底层 API 获取活动窗口信息
- 结合多模态模型识别用户正在做什么

---

### 架构图

```
┌────────────────────────────────────────────────────────────────────┐
│                        Electron 桌面应用                            │
├────────────────────────────────────────────────────────────────────┤
│                                                                    │
│  ┌──────────────────┐     ┌──────────────────────────────────┐    │
│  │   Live2D 模型     │     │         悬浮菜单                  │    │
│  │  ┌────────────┐  │     │  ┌──────────────────────────┐    │    │
│  │  │   拖动移动   │  │     │  │ 设置 | 语音 | 对话 | ... │    │    │
│  │  │   表情动画   │  │     │  └──────────────────────────┘    │    │
│  │  │   贴边停靠   │  │     │         ▲ hover 触发             │    │
│  │  └────────────┘  │     └──────────────────────────────────┘    │
│  └──────────────────┘                                              │
│          │                                                         │
│          ▼                                                         │
│  ┌──────────────────────────────────────────────────────────┐     │
│  │                    底部对话框 + 气泡                       │     │
│  │  ┌────────────────────────────────────────────────────┐  │     │
│  │  │  🐱: 你今天已经用 VSCode 3 小时了，休息一下吧～      │  │     │
│  │  │                                         [ 💬 输入 ] │  │     │
│  │  └────────────────────────────────────────────────────┘  │     │
│  └──────────────────────────────────────────────────────────┘     │
│                                                                    │
└────────────────────────────────────────────────────────────────────┘
```

---

### 技术实现方向

| 功能模块 | 实现方案 |
|----------|----------|
| 窗口管理 | Electron BrowserWindow API |
| Win API 调用 | node-ffi-napi / edge.js |
| 多模态识别 | 后端 Python 处理，前端通过 IPC 通信 |
| 模型控制 | pixi-live2d-display + InternalModel API |
